<!DOCTYPE html>
<html>
<head>
    <title>Export Functions Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .test-section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .test-button { background: #007bff; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; margin: 10px; }
        .test-button:hover { background: #0056b3; }
        .description { color: #666; margin-bottom: 15px; }
    </style>
</head>
<body>
    <h1>üß™ Export Functions Test Page</h1>
    <p>Test the three export functions implemented for the insights dashboard:</p>
    
    <div class="test-section">
        <h3>üìÑ PDF Export Test</h3>
        <div class="description">
            Creates a comprehensive PDF report with summary data, weak areas, and recommendations.
            Opens in a new window with print dialog.
        </div>
        <button class="test-button" onclick="testPDFExport()">Test PDF Export</button>
    </div>
    
    <div class="test-section">
        <h3>üìß Email Report Test</h3>
        <div class="description">
            Creates an email with report summary and link to full dashboard.
            Opens default email client with pre-filled content.
        </div>
        <button class="test-button" onclick="testEmailExport()">Test Email Report</button>
    </div>
    
    <div class="test-section">
        <h3>üñ®Ô∏è Print Report Test</h3>
        <div class="description">
            Creates a print-friendly version of the insights report.
            Opens in new window and triggers print dialog.
        </div>
        <button class="test-button" onclick="testPrintExport()">Test Print Report</button>
    </div>
    
    <div class="test-section">
        <h3>üîó Go to Full Insights Dashboard</h3>
        <div class="description">
            Test the actual export buttons on the main insights page.
        </div>
        <a href="/insights.html" class="test-button" style="text-decoration: none; display: inline-block;">Open Insights Dashboard</a>
    </div>
    
    <script>
        // Mock insights data for testing
        const mockData = {
            summary: {
                totalStudyTime: 24,
                tasksCompleted: 5,
                tasksAssigned: 8,
                quizAverage: 86,
                casesReviewed: 12
            },
            weakAreas: [
                { topic: 'Criminal Law Test', score: 77 },
                { topic: 'Criminal Procedure', score: 79 },
                { topic: 'Torts Test', score: 83 }
            ],
            recommendations: [
                { title: 'Focus on Criminal Law Test', text: 'Schedule extra study time for this topic.' },
                { title: 'Practice Criminal Procedure', text: 'Review Miranda rights and search & seizure cases.' }
            ],
            topicPerformance: {
                labels: ['Constitutional Law', 'Contract Law', 'Criminal Law', 'Torts'],
                datasets: [{ data: [88, 94, 77, 83] }]
            },
            consistency: { values: [85, 15] }
        };
        
        function testPDFExport() {
            const pdfContent = generateTestPDFContent(mockData);
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>LexiAid Test PDF Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; color: #333; }
                        .header { text-align: center; border-bottom: 2px solid #007bff; padding-bottom: 20px; margin-bottom: 30px; }
                        .logo { font-size: 24px; font-weight: bold; color: #007bff; }
                        .summary-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 30px; }
                        .summary-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; text-align: center; }
                        .summary-value { font-size: 28px; font-weight: bold; color: #007bff; }
                        .summary-label { color: #6c757d; margin-top: 5px; }
                        .section { margin-bottom: 30px; }
                        .section-title { font-size: 18px; font-weight: bold; border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 15px; }
                        .weak-area { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
                        .score { font-weight: bold; color: #ffc107; }
                        .recommendation { margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px; }
                        .footer { margin-top: 40px; text-align: center; color: #6c757d; font-size: 12px; border-top: 1px solid #ddd; padding-top: 20px; }
                        @media print { body { margin: 0; } .no-print { display: none; } }
                    </style>
                </head>
                <body>
                    ${pdfContent}
                    <div class="no-print" style="text-align: center; margin-top: 30px;">
                        <button onclick="window.print()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">Print/Save as PDF</button>
                        <button onclick="window.close()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-left: 10px;">Close</button>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
        }
        
        function generateTestPDFContent(data) {
            const currentDate = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
            });
            
            return `
                <div class="header">
                    <div class="logo">LexiAid</div>
                    <h1>Study Insights Report (TEST)</h1>
                    <div>Weekly Report ‚Ä¢ Generated on ${currentDate}</div>
                </div>
                
                <div class="summary-grid">
                    <div class="summary-card">
                        <div class="summary-value">${data.summary.totalStudyTime}</div>
                        <div class="summary-label">Hours Studied</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${data.summary.tasksCompleted}/${data.summary.tasksAssigned}</div>
                        <div class="summary-label">Tasks Completed</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${data.summary.quizAverage}%</div>
                        <div class="summary-label">Quiz Average</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${data.summary.casesReviewed}</div>
                        <div class="summary-label">Cases Reviewed</div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">Areas for Improvement</div>
                    ${data.weakAreas.map(area => `
                        <div class="weak-area">
                            <span>${area.topic}</span>
                            <span class="score">${area.score}%</span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="section">
                    <div class="section-title">Personalized Recommendations</div>
                    ${data.recommendations.map(rec => `
                        <div class="recommendation">
                            <strong>${rec.title}:</strong> ${rec.text}
                        </div>
                    `).join('')}
                </div>
                
                <div class="footer">
                    <p>Generated by LexiAid Study Insights ‚Ä¢ ${currentDate}</p>
                    <p>This is a test report demonstrating PDF export functionality.</p>
                </div>
            `;
        }
        
        function testEmailExport() {
            const currentDate = new Date().toLocaleDateString('en-US', { 
                year: 'numeric', month: 'long', day: 'numeric' 
            });
            
            const subject = `LexiAid Weekly Study Insights Report - ${currentDate} (TEST)`;
            const body = `Hi there!

This is a test of the email export functionality from LexiAid.

Test Summary:
‚Ä¢ Study Time: 24 hours this week
‚Ä¢ Tasks: 5/8 completed  
‚Ä¢ Quiz Average: 86%
‚Ä¢ Cases Reviewed: 12

Areas needing attention:
‚Ä¢ Criminal Law Test: 77%
‚Ä¢ Criminal Procedure: 79%

To view the full interactive report with charts and detailed analytics, please visit:
${window.location.origin}/insights.html

Generated on ${currentDate} by LexiAid Study Insights (Test Mode).

Best regards!`;

            const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            try {
                window.location.href = mailtoLink;
            } catch (error) {
                alert('Email client not available. Email content would be copied to clipboard in the real implementation.');
                console.log('Email content:', subject + '\n\n' + body);
            }
        }
        
        function testPrintExport() {
            const currentDate = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
            });
            
            const printContent = `
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 24px; font-weight: bold;">LexiAid</div>
                    <h1>Study Insights Report (TEST)</h1>
                    <p>Weekly Report ‚Ä¢ Generated on ${currentDate}</p>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 20px 0; text-align: center; color: #6c757d;">
                    üìä For interactive charts and detailed visualizations, visit the online dashboard
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0;">
                    <div style="text-align: center; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
                        <div style="font-size: 24px; font-weight: bold;">24</div>
                        <div style="color: #666; margin-top: 5px; font-size: 14px;">Hours Studied</div>
                    </div>
                    <div style="text-align: center; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
                        <div style="font-size: 24px; font-weight: bold;">5/8</div>
                        <div style="color: #666; margin-top: 5px; font-size: 14px;">Tasks Completed</div>
                    </div>
                    <div style="text-align: center; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
                        <div style="font-size: 24px; font-weight: bold;">86%</div>
                        <div style="color: #666; margin-top: 5px; font-size: 14px;">Quiz Average</div>
                    </div>
                    <div style="text-align: center; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
                        <div style="font-size: 24px; font-weight: bold;">12</div>
                        <div style="color: #666; margin-top: 5px; font-size: 14px;">Cases Reviewed</div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <div style="font-size: 18px; font-weight: bold; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 15px;">Areas for Improvement</div>
                    <div style="margin: 10px 0; padding: 10px; border-left: 4px solid #007bff; background: #f8f9fa;">Criminal Law Test: <strong>77%</strong></div>
                    <div style="margin: 10px 0; padding: 10px; border-left: 4px solid #007bff; background: #f8f9fa;">Criminal Procedure: <strong>79%</strong></div>
                    <div style="margin: 10px 0; padding: 10px; border-left: 4px solid #007bff; background: #f8f9fa;">Torts Test: <strong>83%</strong></div>
                </div>
                
                <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px; border-top: 1px solid #ddd; padding-top: 20px;">
                    <p>Generated by LexiAid Study Insights ‚Ä¢ ${currentDate}</p>
                    <p>This is a test of the print export functionality.</p>
                </div>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>LexiAid Test Print Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; color: #333; }
                        @media print { body { margin: 10px; } }
                    </style>
                </head>
                <body>
                    ${printContent}
                </body>
                </html>
            `);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
            }, 500);
        }
    </script>
</body>
</html>
